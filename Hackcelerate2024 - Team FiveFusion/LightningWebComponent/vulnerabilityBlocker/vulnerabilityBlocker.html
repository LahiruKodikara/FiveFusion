<!-- Vulnerability Alert -->
<template>
    <div class="slds-box_border" style="border-width: 3px; border-color: orange;" if:true={showVulnerabilityAlert}>
        <!--Heading Section-->
        <div class="slds-p-around_x-small slds-border_bottom" style="border-width: 3px; border-color: orange; background-color:orange;">
            <span class="slds-text-heading_medium slds-p-around_small" style="color: white;"><b>COPADO PMD</b> - New Vulnerability detected - v1.0</span>
        </div>

        <!--Body Section-->
        <div class="slds-p-around_x-small">
            <lightning-accordion onsectiontoggle={handleToggleSection}
                                 active-section-name="warningMsg">
                <lightning-accordion-section name="warningMsg" label="New vulnerabilities have been introduced in Apex class">
                    <span class="slds-text-body_regular">We have identified a new vulnerability/vulnerabilities have been introduced in below Apex classes:  in the code. Please follow the steps below to resolve it:</span>
                    <div class="slds-p-top_small slds-p-bottom_small">
                        <ul class="slds-list_dotted slds-text-body_regular">
                            <template for:each={violatedApexClasses} for:item="apexClass">
                                <li key={apexClass.name}>{apexClass.name}</li>
                            </template>
                        </ul>
                    </div>

                    <span class="slds-text-body_regular slds-text-heading_label">Please follow the below steps resolve the triggered validation:</span>
                    <div class="slds-p-top_x-small">
                        <ul class="slds-has-dividers_bottom-space">
                            <li class="slds-item"><b>Step 1: </b>Click on <a href={latestStaticCodeAnalysisLink} target="_blank">View Static Code Analysis Results</a> and check the latest Copado PMD results for the User Story
                                <ul class="slds-list_dotted slds-text-body_regular slds-p-top_x-small">
                                    <li>NOTE: If you can't find the link above. Please go to 'Related' tab in the User story record Page. Click on 'Static Code Analysis Results' and check the latest results</li>
                                </ul>
                            </li>
                            <li class="slds-item"><b>Step 2: </b>Check if there is a vulnerability detected on the mentioned Apex class line which you modified/added newly as part of your development.</li>
                            <li class="slds-item"><b>Step 3: </b>You need to only fix the new violation on the line you modified/added while other violations can be ignored. Recommit the change to the User story.</li>
                            <li class="slds-item"><b>Step 4: </b>Rerun the Copado PMD for the User story and make sure you don't get the warning again.</li>
                        </ul>
                    </div>

                    <div class="slds-p-around_small">
                        <span class="slds-text-body_regular" style="color: green;"><b>RESOLUTION : </b>Fix the newly introduced vulnerability, recommit and rerun the Copado PMD. If it cannot be fixed, then ask your team TL/Admin to by-pass this validation and allow you to promote.</span>
                    </div>
                </lightning-accordion-section>

            </lightning-accordion>
        </div>
    </div>
</template>